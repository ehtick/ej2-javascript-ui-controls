import { DocumentEditor } from '../../src/document-editor/document-editor';
import { createElement } from '@syncfusion/ej2-base';
import { BookmarkElementBox, ContentControlInfo, Editor } from '../../src/index';
import { TestHelper } from '../test-helper.spec';
import { LayoutViewer, PageLayoutViewer } from '../../src/index';
import { Selection } from '../../src/index';
import { WListLevel } from '../../src/document-editor/implementation/list/list-level';
import { EditorHistory } from '../../src/document-editor/implementation/editor-history/editor-history';
import { LineWidget, FieldElementBox, BodyWidget, ParagraphWidget, HeaderFooters, TextElementBox, TableCellWidget, TableWidget, TableRowWidget, Widget } from '../../src/index';
import { WSectionFormat } from '../../src/document-editor/implementation/format/section-format';
import { WParagraphFormat } from '../../src/document-editor/implementation/format/paragraph-format';
import { WCharacterFormat } from '../../src/document-editor/implementation/format/character-format';
import { HyperlinkDialog } from '../../src/document-editor/implementation/dialogs/hyperlink-dialog';
import { JsonAdaptor } from '@syncfusion/ej2-data';
import { BookmarkDialog } from '../../src/document-editor/implementation/dialogs/bookmark-dialog';

/**
 * Editor Spec
 */

describe('undo and redo the deleted text', () => {
    let editor: DocumentEditor;
    let event: any;
    let sfdtContent: any = { "optimizeSfdt": false, "sections": [{ "sectionFormat": { "pageWidth": 612, "pageHeight": 792, "leftMargin": 72, "rightMargin": 72, "topMargin": 72, "bottomMargin": 72, "headerDistance": 36, "footerDistance": 36, "differentFirstPage": false, "differentOddAndEvenPages": false, "bidi": false, "breakCode": "NewPage", "endnoteNumberFormat": "LowerCaseRoman", "footNoteNumberFormat": "Arabic", "restartIndexForFootnotes": "DoNotRestart", "restartIndexForEndnotes": "DoNotRestart", "initialFootNoteNumber": 1, "initialEndNoteNumber": 1, "pageNumberStyle": "Arabic", "numberOfColumns": 1, "equalWidth": true, "lineBetweenColumns": false, "columns": [] }, "blocks": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": {}, "text": "Video provides a powerful way to help you prove your point. When you click Online Video, you can paste in the embed code for the video you want to add. You can also type a keyword to search online for the video that best fits your document. To make your document look professionally produced, Word provides header, footer, cover page, and text box designs that complement each other." }] }], "headersFooters": {} }], "characterFormat": { "fontSize": 12, "fontFamily": "Aptos", "fontSizeBidi": 12, "fontFamilyBidi": "minorBidi", "localeIdBidi": 1025, "localeId": 1033, "localeIdFarEast": 2052, "fontFamilyAscii": "minorHAnsi", "fontFamilyNonFarEast": "minorHAnsi", "fontFamilyFarEast": "minorEastAsia" }, "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "leftIndent": 0, "rightIndent": 0, "firstLineIndent": 0, "textAlignment": "Left", "beforeSpacing": 0, "afterSpacing": 8, "lineSpacing": 1.1583333015441895, "lineSpacingType": "Multiple", "outlineLevel": "BodyText", "bidi": false, "keepLinesTogether": false, "keepWithNext": false, "widowControl": true, "listFormat": {} }, "fontSubstitutionTable": { "DengXian": "等线", "DengXian Light": "等线 Light" }, "themeFontLanguages": { "localeIdBidi": 1037, "localeId": 1033, "localeIdFarEast": 2052 }, "defaultTabWidth": 36, "trackChanges": false, "enforcement": false, "hashValue": "", "saltValue": "", "formatting": false, "protectionType": "NoProtection", "dontUseHTMLParagraphAutoSpacing": false, "formFieldShading": true, "compatibilityMode": "Word2013", "allowSpaceOfSameStyleInTable": false, "themes": { "fontScheme": { "fontSchemeName": "Office", "majorFontScheme": { "fontSchemeList": [{ "name": "latin", "typeface": "Aptos Display", "panose": "02110004020202020204" }, { "name": "ea", "panose": "02110004020202020204" }, { "name": "cs", "panose": "02110004020202020204" }], "fontTypeface": { "Jpan": "游ゴシック Light", "Hang": "맑은 고딕", "Hans": "等线 Light", "Hant": "新細明體", "Arab": "Times New Roman", "Hebr": "Times New Roman", "Thai": "Angsana New", "Ethi": "Nyala", "Beng": "Vrinda", "Gujr": "Shruti", "Khmr": "MoolBoran", "Knda": "Tunga", "Guru": "Raavi", "Cans": "Euphemia", "Cher": "Plantagenet Cherokee", "Yiii": "Microsoft Yi Baiti", "Tibt": "Microsoft Himalaya", "Thaa": "MV Boli", "Deva": "Mangal", "Telu": "Gautami", "Taml": "Latha", "Syrc": "Estrangelo Edessa", "Orya": "Kalinga", "Mlym": "Kartika", "Laoo": "DokChampa", "Sinh": "Iskoola Pota", "Mong": "Mongolian Baiti", "Viet": "Times New Roman", "Uigh": "Microsoft Uighur", "Geor": "Sylfaen", "Armn": "Arial", "Bugi": "Leelawadee UI", "Bopo": "Microsoft JhengHei", "Java": "Javanese Text", "Lisu": "Segoe UI", "Mymr": "Myanmar Text", "Nkoo": "Ebrima", "Olck": "Nirmala UI", "Osma": "Ebrima", "Phag": "Phagspa", "Syrn": "Estrangelo Edessa", "Syrj": "Estrangelo Edessa", "Syre": "Estrangelo Edessa", "Sora": "Nirmala UI", "Tale": "Microsoft Tai Le", "Talu": "Microsoft New Tai Lue", "Tfng": "Ebrima" } }, "minorFontScheme": { "fontSchemeList": [{ "name": "latin", "typeface": "Aptos", "panose": "02110004020202020204" }, { "name": "ea", "panose": "02110004020202020204" }, { "name": "cs", "panose": "02110004020202020204" }], "fontTypeface": { "Jpan": "游ゴシック", "Hang": "맑은 고딕", "Hans": "等线", "Hant": "新細明體", "Arab": "Arial", "Hebr": "Arial", "Thai": "Cordia New", "Ethi": "Nyala", "Beng": "Vrinda", "Gujr": "Shruti", "Khmr": "DaunPenh", "Knda": "Tunga", "Guru": "Raavi", "Cans": "Euphemia", "Cher": "Plantagenet Cherokee", "Yiii": "Microsoft Yi Baiti", "Tibt": "Microsoft Himalaya", "Thaa": "MV Boli", "Deva": "Mangal", "Telu": "Gautami", "Taml": "Latha", "Syrc": "Estrangelo Edessa", "Orya": "Kalinga", "Mlym": "Kartika", "Laoo": "DokChampa", "Sinh": "Iskoola Pota", "Mong": "Mongolian Baiti", "Viet": "Arial", "Uigh": "Microsoft Uighur", "Geor": "Sylfaen", "Armn": "Arial", "Bugi": "Leelawadee UI", "Bopo": "Microsoft JhengHei", "Java": "Javanese Text", "Lisu": "Segoe UI", "Mymr": "Myanmar Text", "Nkoo": "Ebrima", "Olck": "Nirmala UI", "Osma": "Ebrima", "Phag": "Phagspa", "Syrn": "Estrangelo Edessa", "Syrj": "Estrangelo Edessa", "Syre": "Estrangelo Edessa", "Sora": "Nirmala UI", "Tale": "Microsoft Tai Le", "Talu": "Microsoft New Tai Lue", "Tfng": "Ebrima" } } } }, "background": { "color": "#FFFFFFFF" }, "styles": [{ "name": "Normal", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "listFormat": {} }, "characterFormat": {}, "next": "Normal" }, { "name": "Heading 1", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 18, "afterSpacing": 4, "outlineLevel": "Level1", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontSize": 20, "fontFamily": "Aptos Display", "fontColor": "#0F4761FF", "fontSizeBidi": 20, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 1 Char", "next": "Normal" }, { "name": "Heading 1 Char", "type": "Character", "characterFormat": { "fontSize": 20, "fontFamily": "Aptos Display", "fontColor": "#0F4761FF", "fontSizeBidi": 20, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Default Paragraph Font", "type": "Character", "characterFormat": {} }, { "name": "Heading 2", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 8, "afterSpacing": 4, "outlineLevel": "Level2", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontSize": 16, "fontFamily": "Aptos Display", "fontColor": "#0F4761FF", "fontSizeBidi": 16, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 2 Char", "next": "Normal" }, { "name": "Heading 2 Char", "type": "Character", "characterFormat": { "fontSize": 16, "fontFamily": "Aptos Display", "fontColor": "#0F4761FF", "fontSizeBidi": 16, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 3", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 8, "afterSpacing": 4, "outlineLevel": "Level3", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontSize": 14, "fontColor": "#0F4761FF", "fontSizeBidi": 14, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 3 Char", "next": "Normal" }, { "name": "Heading 3 Char", "type": "Character", "characterFormat": { "fontSize": 14, "fontColor": "#0F4761FF", "fontSizeBidi": 14, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 4", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 4, "afterSpacing": 2, "outlineLevel": "Level4", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "italic": true, "fontColor": "#0F4761FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 4 Char", "next": "Normal" }, { "name": "Heading 4 Char", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#0F4761FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 5", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 4, "afterSpacing": 2, "outlineLevel": "Level5", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontColor": "#0F4761FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 5 Char", "next": "Normal" }, { "name": "Heading 5 Char", "type": "Character", "characterFormat": { "fontColor": "#0F4761FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 6", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 2, "afterSpacing": 0, "outlineLevel": "Level6", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "italic": true, "fontColor": "#595959FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 6 Char", "next": "Normal" }, { "name": "Heading 6 Char", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#595959FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 7", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "beforeSpacing": 2, "afterSpacing": 0, "outlineLevel": "Level7", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontColor": "#595959FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 7 Char", "next": "Normal" }, { "name": "Heading 7 Char", "type": "Character", "characterFormat": { "fontColor": "#595959FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 8", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 0, "outlineLevel": "Level8", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "italic": true, "fontColor": "#272727FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 8 Char", "next": "Normal" }, { "name": "Heading 8 Char", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#272727FF", "italicBidi": true, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Heading 9", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 0, "outlineLevel": "Level9", "keepLinesTogether": true, "keepWithNext": true, "listFormat": {} }, "characterFormat": { "fontColor": "#272727FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Normal", "link": "Heading 9 Char", "next": "Normal" }, { "name": "Heading 9 Char", "type": "Character", "characterFormat": { "fontColor": "#272727FF", "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia" }, "basedOn": "Default Paragraph Font" }, { "name": "Normal Table", "type": "Table", "next": "Normal Table" }, { "name": "Title", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 4, "lineSpacing": 1, "lineSpacingType": "Multiple", "contextualSpacing": true, "listFormat": {} }, "characterFormat": { "fontSize": 28, "fontFamily": "Aptos Display", "fontSizeBidi": 28, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia", "characterSpacing": -0.5 }, "basedOn": "Normal", "link": "Title Char", "next": "Normal" }, { "name": "Title Char", "type": "Character", "characterFormat": { "fontSize": 28, "fontFamily": "Aptos Display", "fontSizeBidi": 28, "fontFamilyBidi": "majorBidi", "fontFamilyAscii": "majorHAnsi", "fontFamilyNonFarEast": "majorHAnsi", "fontFamilyFarEast": "majorEastAsia", "characterSpacing": -0.5 }, "basedOn": "Default Paragraph Font" }, { "name": "Subtitle", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "listFormat": { "listLevelNumber": 1 } }, "characterFormat": { "fontSize": 14, "fontColor": "#595959FF", "fontSizeBidi": 14, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia", "characterSpacing": 0.75 }, "basedOn": "Normal", "link": "Subtitle Char", "next": "Normal" }, { "name": "Subtitle Char", "type": "Character", "characterFormat": { "fontSize": 14, "fontColor": "#595959FF", "fontSizeBidi": 14, "fontFamilyBidi": "majorBidi", "fontFamilyFarEast": "majorEastAsia", "characterSpacing": 0.75 }, "basedOn": "Default Paragraph Font" }, { "name": "Quote", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "textAlignment": "Center", "beforeSpacing": 8, "listFormat": {} }, "characterFormat": { "italic": true, "fontColor": "#404040FF", "italicBidi": true }, "basedOn": "Normal", "link": "Quote Char", "next": "Normal" }, { "name": "Quote Char", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#404040FF", "italicBidi": true }, "basedOn": "Default Paragraph Font" }, { "name": "List Paragraph", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "leftIndent": 36, "contextualSpacing": true, "listFormat": {} }, "characterFormat": {}, "basedOn": "Normal", "next": "List Paragraph" }, { "name": "Intense Emphasis", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#0F4761FF", "italicBidi": true }, "basedOn": "Default Paragraph Font" }, { "name": "Intense Quote", "type": "Paragraph", "paragraphFormat": { "borders": { "top": { "color": "#0F4761FF", "hasNoneStyle": false, "lineStyle": "Single", "lineWidth": 0.5, "shadow": false, "space": 10 }, "left": {}, "right": {}, "bottom": { "color": "#0F4761FF", "hasNoneStyle": false, "lineStyle": "Single", "lineWidth": 0.5, "shadow": false, "space": 10 }, "horizontal": {}, "vertical": {} }, "leftIndent": 43.20000076293945, "rightIndent": 43.20000076293945, "textAlignment": "Center", "beforeSpacing": 18, "afterSpacing": 18, "listFormat": {} }, "characterFormat": { "italic": true, "fontColor": "#0F4761FF", "italicBidi": true }, "basedOn": "Normal", "link": "Intense Quote Char", "next": "Normal" }, { "name": "Intense Quote Char", "type": "Character", "characterFormat": { "italic": true, "fontColor": "#0F4761FF", "italicBidi": true }, "basedOn": "Default Paragraph Font" }, { "name": "Intense Reference", "type": "Character", "characterFormat": { "bold": true, "fontColor": "#0F4761FF", "boldBidi": true, "characterSpacing": 0.25 }, "basedOn": "Default Paragraph Font" }, { "name": "Revision", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 0, "lineSpacing": 1, "lineSpacingType": "Multiple", "listFormat": {} }, "characterFormat": {}, "next": "Revision" }, { "name": "Header", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 0, "lineSpacing": 1, "lineSpacingType": "Multiple", "listFormat": {} }, "characterFormat": {}, "basedOn": "Normal", "next": "Header" }, { "name": "Footer", "type": "Paragraph", "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "afterSpacing": 0, "lineSpacing": 1, "lineSpacingType": "Multiple", "listFormat": {} }, "characterFormat": {}, "basedOn": "Normal", "next": "Footer" }], "lists": [], "abstractLists": [], "comments": [], "revisions": [], "customXml": [], "images": {}, "footnotes": { "separator": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": {}, "text": "\u0003" }] }], "continuationSeparator": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": {}, "text": "\u0004" }] }], "continuationNotice": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }] }, "endnotes": { "separator": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": {}, "text": "\u0003" }] }], "continuationSeparator": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [{ "characterFormat": {}, "text": "\u0004" }] }], "continuationNotice": [{ "paragraphFormat": { "borders": { "top": {}, "left": {}, "right": {}, "bottom": {}, "horizontal": {}, "vertical": {} }, "styleName": "Normal", "listFormat": {} }, "characterFormat": {}, "inlines": [] }] } }
    beforeAll((): void => {
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        editor = new DocumentEditor({ enableEditor: true, isReadOnly: false });
        DocumentEditor.Inject(Editor, Selection, EditorHistory); editor.enableEditorHistory = true;
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
    });
    afterAll((done): void => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        setTimeout(function () {
            document.body.innerHTML = '';
            done();
        }, 1000);
    });
    it('undo and redo the deleted text', () => {
        console.log('undo and redo the deleted text');
        editor.open(sfdtContent);
        editor.enableTrackChanges = true;
        editor.selection.select('0;0;263', '0;0;263');
        for (let i: number = 0; i < 12; i++) {
            editor.editor.delete();
        }
        for (let i: number = 0; i < 12; i++) {
            editor.editorHistory.undo();
        }
        for (let i: number = 0; i < 12; i++) {
            editor.editorHistory.redo();
        }
        expect(editor.revisions.changes[0].getRange().length).toBe(12);
    });

    it('selection to be correct position for next line in deleted text', () => {
        console.log('selection to be correct position in deleted text');
        editor.open(sfdtContent);
        editor.enableTrackChanges = true;
        editor.selection.select('0;0;263', '0;0;263');
        for (let i: number = 0; i < 6; i++) {
            editor.editor.delete();
        }
        expect(editor.selection.startOffset).toBe('0;0;269');
        expect(editor.selection.endOffset).toBe('0;0;269');
    });
});