import { DocumentEditor } from '../../src/document-editor/document-editor';
import { createElement } from '@syncfusion/ej2-base';
import { Editor } from '../../src/index';
import { TestHelper } from '../test-helper.spec';
import { Selection } from '../../src/index';
import { EditorHistory } from '../../src/document-editor/implementation/editor-history/editor-history';
import { HyperlinkDialog } from '../../src/document-editor/implementation/dialogs/hyperlink-dialog';
import { SfdtExport } from '../../src/document-editor/implementation/writer/sfdt-export';

describe('Get context based paste option', () => {
    let editor: DocumentEditor;
    let event: any;
    beforeAll((): void => {
        let ele: HTMLElement = createElement('div', { id: 'container' });
        document.body.appendChild(ele);
        editor = new DocumentEditor({ enableEditor: true, isReadOnly: false, enableEditorHistory: true, enableHyperlinkDialog: true });
        DocumentEditor.Inject(Editor, Selection, EditorHistory, HyperlinkDialog,SfdtExport);
        (editor.documentHelper as any).containerCanvasIn = TestHelper.containerCanvas;
        (editor.documentHelper as any).selectionCanvasIn = TestHelper.selectionCanvas;
        (editor.documentHelper.render as any).pageCanvasIn = TestHelper.pageCanvas;
        (editor.documentHelper.render as any).selectionCanvasIn = TestHelper.pageSelectionCanvas;
        editor.appendTo('#container');
    });
    afterAll((done): void => {
        editor.destroy();
        document.body.removeChild(document.getElementById('container'));
        editor = undefined;
        setTimeout(function () {
            
            done();
        }, 1000);
    });
    
    it('Get the paste option for first row when optimised sfdt contains only table',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        var optimizeSfdt = '{"sfdt":"UEsDBBQAAAAIAEgv/1i7Bcos3gMAAL0qAAAEAAAAc2ZkdOyaXW/bNhSG/wrBXezGNfQZWb5r43jYxbqg9a62XJASZROjKIGkkqaB//sOSdlxsnirGw/rMMaAeEQefj9+eRzpAXe94S3/zD42tcFzowY2wZpVeP7rA6buqtzVqB6MB0yo+h3P4wne1MqneB5NI0ihOiS0Vtr6CeOu2vmIu9FJb5yT7neVJDhE2wlW65PcTX+SOz1tMLcneW9O8q7r09yHE9zBX7Q2a5ZHaZkWsKxPb83TW3p4C5UPd71qbMfU9dvoz5AmtidKOZjg27tyTYnz0MSnhvhS7pkRMEB8SQZNBFqSynQKT/6m5e3N9gbaqTxtVSfsJMFT3Y1Gf+dBu/U9/pm3aLdQRX5spdxU8XfvFvazXOInAH5d/Uciv64+feX4/8PMatc8Xbs5XUX24+dUQd04j6ZZUpZlclHkxSxOcqhyfkjfKc4acY9qpivFKUM/ypr1DC7SoKtbuAZyA7nfIrkfWMMUkxVDpkOk7wWvCBUM9R1Y96gniqwV6TcacYkW1z+hOAsoB5RfjfKNhfnlqDAKUeG3tblnjgr3gvFMin4ejOY1Q12DfvmIruSarFlrD9AVI+33Gl120qhOoDfoUnCb3ynUmQ1TSHbyzWKFVhuuanRNlLnfa9RjZ0GV/neq9IXn6DEgA1IBqTMjtQ+34oBTwCmERyE8Ond4pCE+eg/xEPgsmOi4MQwtuWpREJwgOK8+v14iK4AVwDpfYJQEnAJOITAKgdEXB0Yuurn6xKrB8E7OfbTzw8BrAnIyQdeKVIZXDL3ltZ4gImu06kBCgs4EnXn1sfWUvYBUQOp8kVAacAo4/VUkZEmAdZGDENAs09XONlSMAdLQGNdP5fCYZnGRJsmsyKKLMonT8tkZDe0mUV6W2bPD+iDfHMmnR/IFl+OM7NPn6BHQEJv9q1TZJ/U2oydj6jycSFkxcnBtrPiAr2aj3vTQbl7mU0virCjKpLyYzWBLoZdZFk/LKIqSLIuBriT3aBXuvQC1t8zeonurbno3hrpj3hjHpnrpidE+ZRLGk0xwY1Nbzncp835rOzv8VhHKK9BOalXgPbu7JmuGt3ZC1MHjxGE5/llx0Obe669rRrp/c6iWCGhDfjq8e6bGMBTIwCveMo2gI/Sha4kNAsDDvQkx+pCXnZqGHSmQR0o4MBFHaWot6xJH+czarrNoPGP8F97OYsEaMghjH1/5lzjQspMG25WoDWxleuHG1/p5m8qvonlcbLspG9MKZxGj/I+spvGUNdKuhnZLd3iA/TYAByn2AlUdKc925XJffmN/3EHH/0SrVdd6tmCvQR1h/Ns/AAAA//8DAFBLAQItABQAAAAIAEgv/1i7Bcos3gMAAL0qAAAEAAAAAAAAAAAAIAAAAAAAAABzZmR0UEsFBgAAAAABAAEAMgAAAAAEAAAAAA=="}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(optimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('NewColumn');
        expect(availableOptions[1]).toBe('NestTable');
        expect(availableOptions[2]).toBe('NewRow');
    });

    it('Get the paste option for second row when optimised sfdt contains only table',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        editor.selection.handleDownKey();
        var optimizeSfdt = '{"sfdt":"UEsDBBQAAAAIAEgv/1i7Bcos3gMAAL0qAAAEAAAAc2ZkdOyaXW/bNhSG/wrBXezGNfQZWb5r43jYxbqg9a62XJASZROjKIGkkqaB//sOSdlxsnirGw/rMMaAeEQefj9+eRzpAXe94S3/zD42tcFzowY2wZpVeP7rA6buqtzVqB6MB0yo+h3P4wne1MqneB5NI0ihOiS0Vtr6CeOu2vmIu9FJb5yT7neVJDhE2wlW65PcTX+SOz1tMLcneW9O8q7r09yHE9zBX7Q2a5ZHaZkWsKxPb83TW3p4C5UPd71qbMfU9dvoz5AmtidKOZjg27tyTYnz0MSnhvhS7pkRMEB8SQZNBFqSynQKT/6m5e3N9gbaqTxtVSfsJMFT3Y1Gf+dBu/U9/pm3aLdQRX5spdxU8XfvFvazXOInAH5d/Uciv64+feX4/8PMatc8Xbs5XUX24+dUQd04j6ZZUpZlclHkxSxOcqhyfkjfKc4acY9qpivFKUM/ypr1DC7SoKtbuAZyA7nfIrkfWMMUkxVDpkOk7wWvCBUM9R1Y96gniqwV6TcacYkW1z+hOAsoB5RfjfKNhfnlqDAKUeG3tblnjgr3gvFMin4ejOY1Q12DfvmIruSarFlrD9AVI+33Gl120qhOoDfoUnCb3ynUmQ1TSHbyzWKFVhuuanRNlLnfa9RjZ0GV/neq9IXn6DEgA1IBqTMjtQ+34oBTwCmERyE8Ond4pCE+eg/xEPgsmOi4MQwtuWpREJwgOK8+v14iK4AVwDpfYJQEnAJOITAKgdEXB0Yuurn6xKrB8E7OfbTzw8BrAnIyQdeKVIZXDL3ltZ4gImu06kBCgs4EnXn1sfWUvYBUQOp8kVAacAo4/VUkZEmAdZGDENAs09XONlSMAdLQGNdP5fCYZnGRJsmsyKKLMonT8tkZDe0mUV6W2bPD+iDfHMmnR/IFl+OM7NPn6BHQEJv9q1TZJ/U2oydj6jycSFkxcnBtrPiAr2aj3vTQbl7mU0virCjKpLyYzWBLoZdZFk/LKIqSLIuBriT3aBXuvQC1t8zeonurbno3hrpj3hjHpnrpidE+ZRLGk0xwY1Nbzncp835rOzv8VhHKK9BOalXgPbu7JmuGt3ZC1MHjxGE5/llx0Obe669rRrp/c6iWCGhDfjq8e6bGMBTIwCveMo2gI/Sha4kNAsDDvQkx+pCXnZqGHSmQR0o4MBFHaWot6xJH+czarrNoPGP8F97OYsEaMghjH1/5lzjQspMG25WoDWxleuHG1/p5m8qvonlcbLspG9MKZxGj/I+spvGUNdKuhnZLd3iA/TYAByn2AlUdKc925XJffmN/3EHH/0SrVdd6tmCvQR1h/Ns/AAAA//8DAFBLAQItABQAAAAIAEgv/1i7Bcos3gMAAL0qAAAEAAAAAAAAAAAAIAAAAAAAAABzZmR0UEsFBgAAAAABAAEAMgAAAAAEAAAAAA=="}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(optimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('NestTable');
        expect(availableOptions[1]).toBe('NewRow');
        expect(availableOptions[2]).toBe('OverwriteCells');
    });  

    it('Get the paste option for first row when optimised sfdt contains both table and content',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        var optimizeSfdt ='{"sfdt":"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"}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(optimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('KeepSourceFormatting');
        expect(availableOptions[1]).toBe('MergeWithExistingFormatting');
        expect(availableOptions[2]).toBe('KeepTextOnly');
    });

    it('Get the paste option for first row when uoptimised sfdt contains only table',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        let unOptimizeSfdt = '{"optimizeSfdt":false,"sections":[{"sectionFormat":{"pageWidth":612,"pageHeight":792,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"headerDistance":36,"footerDistance":36,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"breakCode":"NewPage","endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart","initialFootNoteNumber":1,"initialEndNoteNumber":1,"pageNumberStyle":"Arabic","numberOfColumns":1,"equalWidth":true,"lineBetweenColumns":false,"columns":[]},"blocks":[{"rows":[{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}},{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}}],"grid":[234,234],"tableFormat":{"borders":{"top":{"lineStyle":"Single","lineWidth":0.5},"left":{"lineStyle":"Single","lineWidth":0.5},"right":{"lineStyle":"Single","lineWidth":0.5},"bottom":{"lineStyle":"Single","lineWidth":0.5},"diagonalDown":{},"diagonalUp":{},"horizontal":{"lineStyle":"Single","lineWidth":0.5},"vertical":{"lineStyle":"Single","lineWidth":0.5}},"shading":{},"leftIndent":0,"topMargin":0,"rightMargin":5.4,"leftMargin":5.4,"bottomMargin":0,"preferredWidthType":"Auto"},"columnCount":2},{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"headersFooters":{}}],"characterFormat":{"bold":false,"italic":false,"fontSize":11,"fontFamily":"Calibri","underline":"None","strikethrough":"None","baselineAlignment":"Normal","highlightColor":"NoColor","fontSizeBidi":11,"fontFamilyBidi":"Calibri","allCaps":false,"fontFamilyAscii":"Calibri","fontFamilyNonFarEast":"Calibri","fontFamilyFarEast":"Calibri"},"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":0,"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","outlineLevel":"BodyText","bidi":false,"keepLinesTogether":false,"keepWithNext":false,"widowControl":true,"listFormat":{}},"fontSubstitutionTable":{},"themeFontLanguages":{},"defaultTabWidth":36,"trackChanges":false,"enforcement":false,"hashValue":"","saltValue":"","formatting":false,"protectionType":"NoProtection","dontUseHTMLParagraphAutoSpacing":false,"formFieldShading":true,"compatibilityMode":"Word2013","allowSpaceOfSameStyleInTable":false,"background":{"color":"#FFFFFF"},"styles":[{"name":"Normal","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"listFormat":{}},"characterFormat":{},"next":"Normal"},{"name":"Heading 1","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":12,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level1","listFormat":{}},"characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 1 Char","next":"Normal"},{"name":"Heading 1 Char","type":"Character","characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Default Paragraph Font","type":"Character","characterFormat":{}},{"name":"Heading 2","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level2","listFormat":{}},"characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 2 Char","next":"Normal"},{"name":"Heading 2 Char","type":"Character","characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 3","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level3","listFormat":{}},"characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 3 Char","next":"Normal"},{"name":"Heading 3 Char","type":"Character","characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 4","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level4","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 4 Char","next":"Normal"},{"name":"Heading 4 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 5","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level5","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 5 Char","next":"Normal"},{"name":"Heading 5 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 6","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level6","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 6 Char","next":"Normal"},{"name":"Heading 6 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 7","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level7","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 7 Char","next":"Normal"},{"name":"Heading 7 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 8","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level8","listFormat":{}},"characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 8 Char","next":"Normal"},{"name":"Heading 8 Char","type":"Character","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 9","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level9","listFormat":{}},"characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 9 Char","next":"Normal"},{"name":"Heading 9 Char","type":"Character","characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Header","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Header"},{"name":"Footer","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Footer"}],"lists":[],"abstractLists":[],"comments":[],"revisions":[],"customXml":[],"images":{}}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(unOptimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('NewColumn');
        expect(availableOptions[1]).toBe('NestTable');
        expect(availableOptions[2]).toBe('NewRow');
    });

    it('Get the paste option for second row when unoptimised sfdt contains only table',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        editor.selection.handleDownKey();
        var unOptimizeSfdt = '{"optimizeSfdt":false,"sections":[{"sectionFormat":{"pageWidth":612,"pageHeight":792,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"headerDistance":36,"footerDistance":36,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"breakCode":"NewPage","endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart","initialFootNoteNumber":1,"initialEndNoteNumber":1,"pageNumberStyle":"Arabic","numberOfColumns":1,"equalWidth":true,"lineBetweenColumns":false,"columns":[]},"blocks":[{"rows":[{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}},{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}}],"grid":[234,234],"tableFormat":{"borders":{"top":{"lineStyle":"Single","lineWidth":0.5},"left":{"lineStyle":"Single","lineWidth":0.5},"right":{"lineStyle":"Single","lineWidth":0.5},"bottom":{"lineStyle":"Single","lineWidth":0.5},"diagonalDown":{},"diagonalUp":{},"horizontal":{"lineStyle":"Single","lineWidth":0.5},"vertical":{"lineStyle":"Single","lineWidth":0.5}},"shading":{},"leftIndent":0,"topMargin":0,"rightMargin":5.4,"leftMargin":5.4,"bottomMargin":0,"preferredWidthType":"Auto"},"columnCount":2},{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"headersFooters":{}}],"characterFormat":{"bold":false,"italic":false,"fontSize":11,"fontFamily":"Calibri","underline":"None","strikethrough":"None","baselineAlignment":"Normal","highlightColor":"NoColor","fontSizeBidi":11,"fontFamilyBidi":"Calibri","allCaps":false,"fontFamilyAscii":"Calibri","fontFamilyNonFarEast":"Calibri","fontFamilyFarEast":"Calibri"},"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":0,"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","outlineLevel":"BodyText","bidi":false,"keepLinesTogether":false,"keepWithNext":false,"widowControl":true,"listFormat":{}},"fontSubstitutionTable":{},"themeFontLanguages":{},"defaultTabWidth":36,"trackChanges":false,"enforcement":false,"hashValue":"","saltValue":"","formatting":false,"protectionType":"NoProtection","dontUseHTMLParagraphAutoSpacing":false,"formFieldShading":true,"compatibilityMode":"Word2013","allowSpaceOfSameStyleInTable":false,"background":{"color":"#FFFFFF"},"styles":[{"name":"Normal","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"listFormat":{}},"characterFormat":{},"next":"Normal"},{"name":"Heading 1","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":12,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level1","listFormat":{}},"characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 1 Char","next":"Normal"},{"name":"Heading 1 Char","type":"Character","characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Default Paragraph Font","type":"Character","characterFormat":{}},{"name":"Heading 2","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level2","listFormat":{}},"characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 2 Char","next":"Normal"},{"name":"Heading 2 Char","type":"Character","characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 3","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level3","listFormat":{}},"characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 3 Char","next":"Normal"},{"name":"Heading 3 Char","type":"Character","characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 4","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level4","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 4 Char","next":"Normal"},{"name":"Heading 4 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 5","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level5","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 5 Char","next":"Normal"},{"name":"Heading 5 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 6","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level6","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 6 Char","next":"Normal"},{"name":"Heading 6 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 7","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level7","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 7 Char","next":"Normal"},{"name":"Heading 7 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 8","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level8","listFormat":{}},"characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 8 Char","next":"Normal"},{"name":"Heading 8 Char","type":"Character","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 9","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level9","listFormat":{}},"characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 9 Char","next":"Normal"},{"name":"Heading 9 Char","type":"Character","characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Header","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Header"},{"name":"Footer","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Footer"}],"lists":[],"abstractLists":[],"comments":[],"revisions":[],"customXml":[],"images":{}}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(unOptimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('NestTable');
        expect(availableOptions[1]).toBe('NewRow');
        expect(availableOptions[2]).toBe('OverwriteCells');
    });

    it('Get the paste option for first row when uoptimised sfdt contains both table and content',() =>{
        editor.openBlank();
        editor.editorModule.insertTable(2,2);
        var unOptimizeSfdt = '{"optimizeSfdt":false,"sections":[{"sectionFormat":{"pageWidth":612,"pageHeight":792,"leftMargin":72,"rightMargin":72,"topMargin":72,"bottomMargin":72,"headerDistance":36,"footerDistance":36,"differentFirstPage":false,"differentOddAndEvenPages":false,"bidi":false,"breakCode":"NewPage","endnoteNumberFormat":"LowerCaseRoman","footNoteNumberFormat":"Arabic","restartIndexForFootnotes":"DoNotRestart","restartIndexForEndnotes":"DoNotRestart","initialFootNoteNumber":1,"initialEndNoteNumber":1,"pageNumberStyle":"Arabic","numberOfColumns":1,"equalWidth":true,"lineBetweenColumns":false,"columns":[]},"blocks":[{"rows":[{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}},{"cells":[{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":0},{"blocks":[{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"firstLineIndent":0,"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[]}],"cellFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"shading":{},"preferredWidth":234,"cellWidth":234,"columnSpan":1,"rowSpan":1},"columnIndex":1}],"rowFormat":{"height":0,"heightType":"Auto","borders":{"top":{},"left":{},"right":{},"bottom":{},"diagonalDown":{},"diagonalUp":{},"horizontal":{},"vertical":{}},"gridBefore":0,"gridAfter":0}}],"grid":[234,234],"tableFormat":{"borders":{"top":{"lineStyle":"Single","lineWidth":0.5},"left":{"lineStyle":"Single","lineWidth":0.5},"right":{"lineStyle":"Single","lineWidth":0.5},"bottom":{"lineStyle":"Single","lineWidth":0.5},"diagonalDown":{},"diagonalUp":{},"horizontal":{"lineStyle":"Single","lineWidth":0.5},"vertical":{"lineStyle":"Single","lineWidth":0.5}},"shading":{},"leftIndent":0,"topMargin":0,"rightMargin":5.4,"leftMargin":5.4,"bottomMargin":0,"preferredWidthType":"Auto"},"columnCount":2},{"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"styleName":"Normal","listFormat":{}},"characterFormat":{},"inlines":[{"characterFormat":{"bidi":false},"text":"Table with content"}]}],"headersFooters":{}}],"characterFormat":{"bold":false,"italic":false,"fontSize":11,"fontFamily":"Calibri","underline":"None","strikethrough":"None","baselineAlignment":"Normal","highlightColor":"NoColor","fontSizeBidi":11,"fontFamilyBidi":"Calibri","allCaps":false,"fontFamilyAscii":"Calibri","fontFamilyNonFarEast":"Calibri","fontFamilyFarEast":"Calibri"},"paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":0,"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","outlineLevel":"BodyText","bidi":false,"keepLinesTogether":false,"keepWithNext":false,"widowControl":true,"listFormat":{}},"fontSubstitutionTable":{},"themeFontLanguages":{},"defaultTabWidth":36,"trackChanges":false,"enforcement":false,"hashValue":"","saltValue":"","formatting":false,"protectionType":"NoProtection","dontUseHTMLParagraphAutoSpacing":false,"formFieldShading":true,"compatibilityMode":"Word2013","allowSpaceOfSameStyleInTable":false,"background":{"color":"#FFFFFF"},"styles":[{"name":"Normal","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"listFormat":{}},"characterFormat":{},"next":"Normal"},{"name":"Heading 1","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":12,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level1","listFormat":{}},"characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 1 Char","next":"Normal"},{"name":"Heading 1 Char","type":"Character","characterFormat":{"fontSize":16,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Default Paragraph Font","type":"Character","characterFormat":{}},{"name":"Heading 2","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level2","listFormat":{}},"characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 2 Char","next":"Normal"},{"name":"Heading 2 Char","type":"Character","characterFormat":{"fontSize":13,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 3","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level3","listFormat":{}},"characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 3 Char","next":"Normal"},{"name":"Heading 3 Char","type":"Character","characterFormat":{"fontSize":12,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 4","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level4","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 4 Char","next":"Normal"},{"name":"Heading 4 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 5","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level5","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 5 Char","next":"Normal"},{"name":"Heading 5 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#2F5496","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 6","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level6","listFormat":{}},"characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 6 Char","next":"Normal"},{"name":"Heading 6 Char","type":"Character","characterFormat":{"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 7","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level7","listFormat":{}},"characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 7 Char","next":"Normal"},{"name":"Heading 7 Char","type":"Character","characterFormat":{"italic":true,"fontFamily":"Calibri Light","fontColor":"#1F3763","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 8","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level8","listFormat":{}},"characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 8 Char","next":"Normal"},{"name":"Heading 8 Char","type":"Character","characterFormat":{"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Heading 9","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"leftIndent":0,"rightIndent":0,"firstLineIndent":0,"textAlignment":"Left","beforeSpacing":2,"afterSpacing":0,"lineSpacing":1.0791666507720947,"lineSpacingType":"Multiple","outlineLevel":"Level9","listFormat":{}},"characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Normal","link":"Heading 9 Char","next":"Normal"},{"name":"Heading 9 Char","type":"Character","characterFormat":{"italic":true,"fontSize":10.5,"fontFamily":"Calibri Light","fontColor":"#333333","fontFamilyAscii":"Calibri Light","fontFamilyNonFarEast":"Calibri Light","fontFamilyFarEast":"Calibri Light"},"basedOn":"Default Paragraph Font"},{"name":"Header","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Header"},{"name":"Footer","type":"Paragraph","paragraphFormat":{"borders":{"top":{},"left":{},"right":{},"bottom":{},"horizontal":{},"vertical":{}},"afterSpacing":0,"lineSpacing":1,"lineSpacingType":"Multiple","listFormat":{}},"characterFormat":{},"basedOn":"Normal","next":"Footer"}],"lists":[],"abstractLists":[],"comments":[],"revisions":[],"customXml":[],"images":{}}';
        var availableOptions = editor.selection.getContextBasedPasteOptions(unOptimizeSfdt);
        expect(availableOptions.length).toBe(3);
        expect(availableOptions[0]).toBe('KeepSourceFormatting');
        expect(availableOptions[1]).toBe('MergeWithExistingFormatting');
        expect(availableOptions[2]).toBe('KeepTextOnly');
    });

    it("Get past option with different DOM elements",()=>{
        // When using get context based paste option, we need to skip this element from adding in global collection.
       var sectionWithAllElements = '{"sfdt":"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"}';
       let openDocument = '{"sfdt":"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"}'
       editor.open(openDocument);
       var availableOptions = editor.selection.getContextBasedPasteOptions(sectionWithAllElements);
       expect(editor.documentHelper.bookmarks.length).toBe(0);
       expect(editor.documentHelper.lists.length).toBe(0);
       expect(editor.documentHelper.abstractLists.length).toBe(0);
       expect(editor.documentHelper.fields.length).toBe(0);
       expect(editor.documentHelper.formFields.length).toBe(0);
       expect(editor.documentHelper.images.length).toBe(0);
       expect(editor.documentHelper.comments.length).toBe(0);
       expect(editor.documentHelper.contentControlCollection.length).toBe(0);
       expect(editor.documentHelper.revisionsInternal.length).toBe(0);
       expect(availableOptions[0]).toBe('KeepSourceFormatting');
       expect(availableOptions[1]).toBe('MergeWithExistingFormatting');
       expect(availableOptions[2]).toBe('KeepTextOnly');
    });
});